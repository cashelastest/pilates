{% extends 'base.html' %}
{% set active_page = "stats" %}

{% block title %}Статистика{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{{ url_for('static', path='/css/stats.css') }}">
    <!-- <link rel="stylesheet" href="{{ url_for('static', path='/css/stats-additions.css') }}"> -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
    <main>
        <div class="stats-container">
            <!-- Заголовок и фильтры периодов -->
            <div class="stats-header">
                <h1>Статистика та звітність</h1>
                <div class="period-selector">
                    <button class="period-btn">Тиждень</button>
                    <button class="period-btn active">Місяць</button>
                    <button class="period-btn">Квартал</button>
                    <button class="period-btn">Рік</button>
                    <div class="date-range">
                        <input type="date" class="date-input" id="start-date">
                        <span>—</span>
                        <input type="date" class="date-input" id="end-date">
                        <button class="apply-btn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M20 6L9 17L4 12" stroke="#555555" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    <button class="refresh-btn" title="Оновити дані">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M1 4V10H7M23 20V14H17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10M3.51 15A9 9 0 0 0 18.36 18.36L23 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Оновити
                    </button>
                </div>
            </div>

            <!-- Карточки с ключевыми показателями -->
            <div class="stats-cards">
                <div class="stat-card">
                    <div class="stat-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17 21V19C17 16.7909 15.2091 15 13 15H5C2.79086 15 1 16.7909 1 19V21M23 21V19C23 16.7909 21.2091 15 19 15H18M13 7C13 9.20914 11.2091 11 9 11C6.79086 11 5 9.20914 5 7C5 4.79086 6.79086 3 9 3C11.2091 3 13 4.79086 13 7ZM19 11C19 12.1046 18.1046 13 17 13C15.8954 13 15 12.1046 15 11C15 9.89543 15.8954 9 17 9C18.1046 9 19 9.89543 19 11Z" stroke="#E6B5A2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value">...</div>
                        <div class="stat-label">Активних клієнтів</div>
                    </div>
                    <div class="stat-change">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M18 15L12 9L6 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        ...
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 8V12L15 15M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="#E6B5A2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value">...</div>
                        <div class="stat-label">Заняття за період</div>
                    </div>
                    <div class="stat-change">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M18 15L12 9L6 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        ...
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9 12C9 13.6569 10.3431 15 12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12ZM21 12C21 12 18 19 12 19C6 19 3 12 3 12C3 12 6 5 12 5C18 5 21 12 21 12Z" stroke="#E6B5A2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value">...</div>
                        <div class="stat-label">Середня заповненість</div>
                    </div>
                    <div class="stat-change">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        ...
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2V6M6.31 3L5 5M17.69 3L19 5M12 12V16M4 10H20M4 14H20M7 22H17C18.1046 22 19 21.1046 19 20V8C19 6.89543 18.1046 6 17 6H7C5.89543 6 5 6.89543 5 8V20C5 21.1046 5.89543 22 7 22Z" stroke="#E6B5A2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value">...</div>
                        <div class="stat-label">Дохід за період</div>
                    </div>
                    <div class="stat-change">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M18 15L12 9L6 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        ...
                    </div>
                </div>
            </div>

            <!-- Графики -->
            <div class="stats-charts">
                <div class="chart-container">
                    <div class="chart-header">
                        <h2>Відвідуваність за період</h2>
                        <div class="chart-actions">
                            <button class="chart-action-btn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 5V19M5 12H19" stroke="#555555" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Деталі
                            </button>
                            <button class="chart-action-btn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8 17L12 21M12 21L16 17M12 21V12M20 16.7428C21.2215 15.734 22 14.2079 22 12.5C22 9.46243 19.5376 7 16.5 7C16.2815 7 16.0771 6.886 15.9661 6.69774C14.6621 4.48484 12.2544 3 9.5 3C5.35786 3 2 6.35786 2 10.5C2 12.5661 2.83545 14.4371 4.18695 15.7935" stroke="#555555" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Експорт
                            </button>
                        </div>
                    </div>
                    <div class="chart">
                        <canvas id="attendanceChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <h2>Дохід за категоріями</h2>
                        <div class="chart-actions">
                            <button class="chart-action-btn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 5V19M5 12H19" stroke="#555555" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Деталі
                            </button>
                            <button class="chart-action-btn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8 17L12 21M12 21L16 17M12 21V12M20 16.7428C21.2215 15.734 22 14.2079 22 12.5C22 9.46243 19.5376 7 16.5 7C16.2815 7 16.0771 6.886 15.9661 6.69774C14.6621 4.48484 12.2544 3 9.5 3C5.35786 3 2 6.35786 2 10.5C2 12.5661 2.83545 14.4371 4.18695 15.7935" stroke="#555555" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Експорт
                            </button>
                        </div>
                    </div>
                    <div class="chart">
                        <canvas id="incomeChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Таблица с топ тренерами -->
            <div class="stats-table">
                <div class="table-header">
                    <h2>Ефективність тренерів</h2>
                    <div class="table-actions">
                        <button class="table-action-btn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 17L12 21M12 21L16 17M12 21V12M20 16.7428C21.2215 15.734 22 14.2079 22 12.5C22 9.46243 19.5376 7 16.5 7C16.2815 7 16.0771 6.886 15.9661 6.69774C14.6621 4.48484 12.2544 3 9.5 3C5.35786 3 2 6.35786 2 10.5C2 12.5661 2.83545 14.4371 4.18695 15.7935" stroke="#555555" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Завантажити звіт
                        </button>
                    </div>
                </div>
                <table class="trainers-table">
                    <thead>
                        <tr>
                            <th>Тренер</th>
                            <th>Заняття</th>
                            <th>Клієнти</th>
                            <th>Заповненість</th>
                            <th>Дохід</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Данные будут загружены через JavaScript -->
                    </tbody>
                </table>
            </div>

            <!-- Дополнительные графики -->
            <div class="stats-charts">
                <div class="chart-container">
                    <div class="chart-header">
                        <h2>Популярні заняття</h2>
                        <div class="chart-actions">
                            <button class="chart-action-btn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 5V19M5 12H19" stroke="#555555" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Деталі
                            </button>
                            <button class="chart-action-btn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8 17L12 21M12 21L16 17M12 21V12M20 16.7428C21.2215 15.734 22 14.2079 22 12.5C22 9.46243 19.5376 7 16.5 7C16.2815 7 16.0771 6.886 15.9661 6.69774C14.6621 4.48484 12.2544 3 9.5 3C5.35786 3 2 6.35786 2 10.5C2 12.5661 2.83545 14.4371 4.18695 15.7935" stroke="#555555" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Експорт
                            </button>
                        </div>
                    </div>
                    <div class="chart">
                        <canvas id="classesChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <h2>Динаміка нових клієнтів</h2>
                        <div class="chart-actions">
                            <button class="chart-action-btn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 5V19M5 12H19" stroke="#555555" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Деталі
                            </button>
                            <button class="chart-action-btn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8 17L12 21M12 21L16 17M12 21V12M20 16.7428C21.2215 15.734 22 14.2079 22 12.5C22 9.46243 19.5376 7 16.5 7C16.2815 7 16.0771 6.886 15.9661 6.69774C14.6621 4.48484 12.2544 3 9.5 3C5.35786 3 2 6.35786 2 10.5C2 12.5661 2.83545 14.4371 4.18695 15.7935" stroke="#555555" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Експорт
                            </button>
                        </div>
                    </div>
                    <div class="chart">
                        <canvas id="newClientsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </main>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', path='/js/stats.js') }}"></script>
{% endblock %}